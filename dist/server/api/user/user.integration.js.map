{"version":3,"sources":["../../../../server/api/user/user.integration.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;gBAEG,OAAO;;;;yBACN,cAAc;;;;yBACX,WAAW;;;;AAE/B,QAAQ,CAAC,WAAW,EAAE,YAAW;AAC/B,MAAI,IAAI,CAAC;;;AAGT,QAAM,CAAC,YAAW;AAChB,WAAO,uBAAK,WAAW,EAAE,CAAC,IAAI,CAAC,YAAW;AACxC,UAAI,GAAG,2BAAS;AACd,YAAI,EAAE,WAAW;AACjB,aAAK,EAAE,kBAAkB;AACzB,gBAAQ,EAAE,UAAU;OACrB,CAAC,CAAC;;AAEH,aAAO,IAAI,CAAC,SAAS,EAAE,CAAC;KACzB,CAAC,CAAC;GACJ,CAAC,CAAC;;;AAGH,OAAK,CAAC,YAAW;AACf,WAAO,uBAAK,WAAW,EAAE,CAAC;GAC3B,CAAC,CAAC;;AAEH,UAAQ,CAAC,mBAAmB,EAAE,YAAW;AACvC,QAAI,KAAK,CAAC;;AAEV,UAAM,CAAC,UAAS,IAAI,EAAE;AACpB,gDAAY,CACT,IAAI,CAAC,aAAa,CAAC,CACnB,IAAI,CAAC;AACJ,aAAK,EAAE,kBAAkB;AACzB,gBAAQ,EAAE,UAAU;OACrB,CAAC,CACD,MAAM,CAAC,GAAG,CAAC,CACX,MAAM,CAAC,cAAc,EAAE,MAAM,CAAC,CAC9B,GAAG,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AACjB,aAAK,GAAG,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;AACvB,YAAI,EAAE,CAAC;OACR,CAAC,CAAC;KACN,CAAC,CAAC;;AAEH,MAAE,CAAC,uDAAuD,EAAE,UAAS,IAAI,EAAE;AACzE,gDAAY,CACT,GAAG,CAAC,eAAe,CAAC,CACpB,GAAG,CAAC,eAAe,EAAE,SAAS,GAAG,KAAK,CAAC,CACvC,MAAM,CAAC,GAAG,CAAC,CACX,MAAM,CAAC,cAAc,EAAE,MAAM,CAAC,CAC9B,GAAG,CAAC,UAAC,GAAG,EAAE,GAAG,EAAK;AACjB,WAAG,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;AAC1D,YAAI,EAAE,CAAC;OACR,CAAC,CAAC;KACN,CAAC,CAAC;;AAEH,MAAE,CAAC,kDAAkD,EAAE,UAAS,IAAI,EAAE;AACpE,gDAAY,CACT,GAAG,CAAC,eAAe,CAAC,CACpB,MAAM,CAAC,GAAG,CAAC,CACX,GAAG,CAAC,IAAI,CAAC,CAAC;KACd,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ,CAAC,CAAC","file":"user.integration.js","sourcesContent":["'use strict';\r\n\r\nimport app from '../..';\r\nimport User from './user.model';\r\nimport request from 'supertest';\r\n\r\ndescribe('User API:', function() {\r\n  var user;\r\n\r\n  // Clear users before testing\r\n  before(function() {\r\n    return User.removeAsync().then(function() {\r\n      user = new User({\r\n        name: 'Fake User',\r\n        email: 'test@example.com',\r\n        password: 'password'\r\n      });\r\n\r\n      return user.saveAsync();\r\n    });\r\n  });\r\n\r\n  // Clear users after testing\r\n  after(function() {\r\n    return User.removeAsync();\r\n  });\r\n\r\n  describe('GET /api/users/me', function() {\r\n    var token;\r\n\r\n    before(function(done) {\r\n      request(app)\r\n        .post('/auth/local')\r\n        .send({\r\n          email: 'test@example.com',\r\n          password: 'password'\r\n        })\r\n        .expect(200)\r\n        .expect('Content-Type', /json/)\r\n        .end((err, res) => {\r\n          token = res.body.token;\r\n          done();\r\n        });\r\n    });\r\n\r\n    it('should respond with a user profile when authenticated', function(done) {\r\n      request(app)\r\n        .get('/api/users/me')\r\n        .set('authorization', 'Bearer ' + token)\r\n        .expect(200)\r\n        .expect('Content-Type', /json/)\r\n        .end((err, res) => {\r\n          res.body._id.toString().should.equal(user._id.toString());\r\n          done();\r\n        });\r\n    });\r\n\r\n    it('should respond with a 401 when not authenticated', function(done) {\r\n      request(app)\r\n        .get('/api/users/me')\r\n        .expect(401)\r\n        .end(done);\r\n    });\r\n  });\r\n});\r\n"]}